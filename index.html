<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –°–æ–≤–µ—Ç–Ω–∏–∫</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            padding: 16px;
            margin: 0;
            line-height: 1.5;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--tg-theme-hint-color, #e0e0e0);
        }
        
        .header h1 {
            margin: 0 0 8px 0;
            font-size: 24px;
            color: var(--tg-theme-text-color, #000000);
        }
        
        .header p {
            margin: 0;
            color: var(--tg-theme-hint-color, #707579);
            font-size: 14px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 15px;
            color: var(--tg-theme-text-color, #000000);
        }
        
        .input-group input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--tg-theme-hint-color, #e0e0e0);
            border-radius: 12px;
            background-color: var(--tg-theme-secondary-bg-color, #f5f5f5);
            color: var(--tg-theme-text-color, #000000);
            font-size: 16px;
            transition: border-color 0.2s;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: var(--tg-theme-button-color, #2481cc);
            box-shadow: 0 0 0 2px rgba(36, 129, 204, 0.1);
        }
        
        .input-group .hint {
            margin-top: 6px;
            font-size: 13px;
            color: var(--tg-theme-hint-color, #707579);
        }
        
        .calculate-btn {
            width: 100%;
            padding: 16px;
            background-color: var(--tg-theme-button-color, #2481cc);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 8px;
            transition: opacity 0.2s;
        }
        
        .calculate-btn:hover {
            opacity: 0.9;
        }
        
        .calculate-btn:active {
            opacity: 0.8;
        }
        
        .result-box {
            margin-top: 24px;
            padding: 20px;
            border-radius: 16px;
            background-color: var(--tg-theme-secondary-bg-color, #f5f5f5);
            display: none;
        }
        
        .result-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--tg-theme-text-color, #000000);
        }
        
        .result-item {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        
        .result-label {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #707579);
            margin-bottom: 4px;
        }
        
        .result-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--tg-theme-text-color, #000000);
        }
        
        .positive {
            color: #34C759 !important;
        }
        
        .negative {
            color: #FF3B30 !important;
        }
        
        .warning-box {
            background-color: rgba(255, 204, 0, 0.1);
            border-left: 4px solid #FFCC00;
            padding: 12px 16px;
            margin-top: 16px;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .success-box {
            background-color: rgba(52, 199, 89, 0.1);
            border-left: 4px solid #34C759;
            padding: 12px 16px;
            margin-top: 16px;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .footer {
            margin-top: 24px;
            text-align: center;
            font-size: 12px;
            color: var(--tg-theme-hint-color, #707579);
            padding-top: 16px;
            border-top: 1px solid var(--tg-theme-hint-color, #e0e0e0);
        }
        
        @media (max-width: 480px) {
            body {
                padding: 12px;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .input-group input {
                padding: 12px 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –°–æ–≤–µ—Ç–Ω–∏–∫</h1>
            <p>–†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –≤–∞—à –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–Ω–µ–≤–Ω–æ–π –±—é–¥–∂–µ—Ç</p>
        </div>
        
        <div class="input-group">
            <label for="days">üìÖ –î–Ω–µ–π –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –¥–µ–Ω–µ–≥</label>
            <input type="number" id="days" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 15" value="30" min="1" max="365">
            <div class="hint">–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –æ—Å—Ç–∞–ª–æ—Å—å –¥–æ –∑–∞—Ä–ø–ª–∞—Ç—ã –∏–ª–∏ –¥—Ä—É–≥–æ–≥–æ –¥–æ—Ö–æ–¥–∞</div>
        </div>
        
        <div class="input-group">
            <label for="income">üí∞ –û–±—â–∞—è —Å—É–º–º–∞ –¥–µ–Ω–µ–≥ –Ω–∞ —Ä—É–∫–∞—Ö</label>
            <input type="number" id="income" placeholder="0" min="0" step="100">
            <div class="hint">–û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–∞—Ö + –Ω–∞–ª–∏—á–Ω—ã–µ + –æ–∂–∏–¥–∞–µ–º—ã–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è</div>
        </div>
        
        <div class="input-group">
            <label for="fixed">üè† –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏</label>
            <input type="number" id="fixed" placeholder="0" min="0" step="100">
            <div class="hint">–ê—Ä–µ–Ω–¥–∞, –ñ–ö–•, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, —Å–≤—è–∑—å, –ø–æ–¥–ø–∏—Å–∫–∏</div>
        </div>
        
        <div class="input-group">
            <label for="debts">üí≥ –ü–ª–∞—Ç–µ–∂–∏ –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º</label>
            <input type="number" id="debts" placeholder="0" min="0" step="100">
            <div class="hint">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º –∏ –∫—Ä–µ–¥–∏—Ç–Ω—ã–º –∫–∞—Ä—Ç–∞–º</div>
        </div>
        
        <div class="input-group">
            <label for="savings">üê∑ –ù–∞–∫–æ–ø–ª–µ–Ω–∏—è (—Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–ª–∞—Ç–∏ —Å–µ–±–µ)</label>
            <input type="number" id="savings" placeholder="0" min="0" step="100">
            <div class="hint">–°—É–º–º–∞, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ª–æ–∂–∏—Ç—å –≤ –∫–æ–ø–∏–ª–∫—É</div>
        </div>
        
        <div class="input-group">
            <label for="groceries">üõí –ï–¥–∞ –∏ –±—ã—Ç (–±–∞–∑–æ–≤—ã–µ —Ä–∞—Å—Ö–æ–¥—ã)</label>
            <input type="number" id="groceries" placeholder="0" min="0" step="100">
            <div class="hint">–°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç—ã, –ø—Ä–æ–µ–∑–¥, –±—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è –Ω–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥</div>
        </div>
        
        <button class="calculate-btn" onclick="calculate()">üìä –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –±—é–¥–∂–µ—Ç</button>
        
        <div id="result" class="result-box"></div>
        
        <div class="footer">
            –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –≤–∞—à–µ–º Telegram. –ù–∞–∂–∏–º–∞—è "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç", –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –¥–∞–Ω–Ω—ã—Ö.
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
        tg.enableClosingConfirmation(); // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∫–Ω–æ–ø–∫—É Telegram
        tg.MainButton.setText("üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç");
        tg.MainButton.setParams({
            color: tg.themeParams.button_color || "#2481cc",
            text_color: tg.themeParams.button_text_color || "#ffffff"
        });
        
        // –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞
        function calculate() {
            // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞
            let days = parseFloat(document.getElementById('days').value) || 1;
            if (days < 1) days = 1;
            
            let income = parseFloat(document.getElementById('income').value) || 0;
            let fixed = parseFloat(document.getElementById('fixed').value) || 0;
            let debts = parseFloat(document.getElementById('debts').value) || 0;
            let savings = parseFloat(document.getElementById('savings').value) || 0;
            let groceries = parseFloat(document.getElementById('groceries').value) || 0;
            
            // –í—ã–ø–æ–ª–Ω—è–µ–º —Ä–∞—Å—á–µ—Ç—ã
            let mustSpend = fixed + debts;
            let afterBills = income - mustSpend;
            let netLifeMoney = afterBills - savings;
            let freeMoney = netLifeMoney - groceries;
            
            let dailyTotal = netLifeMoney / days;
            let dailyFun = freeMoney / days;
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —á–∏—Å–ª–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ —Ç—ã—Å—è—á
            function formatNumber(num) {
                return new Intl.NumberFormat('ru-RU', {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(num);
            }
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º HTML –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            let html = `<div class="result-title">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞</div>`;
            
            html += `<div class="result-item">
                <div class="result-label">–í—Å–µ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤</div>
                <div class="result-value">${formatNumber(income)} ‚ÇΩ</div>
            </div>`;
            
            html += `<div class="result-item">
                <div class="result-label">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏</div>
                <div class="result-value">${formatNumber(mustSpend)} ‚ÇΩ</div>
            </div>`;
            
            html += `<div class="result-item">
                <div class="result-label">–ù–∞–∫–æ–ø–ª–µ–Ω–∏—è</div>
                <div class="result-value">${formatNumber(savings)} ‚ÇΩ</div>
            </div>`;
            
            html += `<div class="result-item">
                <div class="result-label">–ë—é–¥–∂–µ—Ç –Ω–∞ –µ–¥—É –∏ –±—ã—Ç</div>
                <div class="result-value">${formatNumber(groceries)} ‚ÇΩ</div>
            </div>`;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏
            if (freeMoney < 0) {
                html += `<div class="result-item">
                    <div class="result-label">–ù–µ–¥–æ—Å—Ç–∞—é—â–∞—è —Å—É–º–º–∞</div>
                    <div class="result-value negative">${formatNumber(Math.abs(freeMoney))} ‚ÇΩ</div>
                </div>`;
                
                html += `<div class="warning-box">
                    üö® <strong>–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è</strong><br>
                    –í–∞–º –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç ${formatNumber(Math.abs(freeMoney))} ‚ÇΩ –¥–∞–∂–µ –Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –∏ –µ–¥—É.
                    –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏.
                </div>`;
            } else {
                html += `<div class="result-item">
                    <div class="result-label">–ú–æ–∂–Ω–æ —Ç—Ä–∞—Ç–∏—Ç—å –≤ –¥–µ–Ω—å (–≤—Å–µ–≥–æ)</div>
                    <div class="result-value positive">${formatNumber(dailyTotal)} ‚ÇΩ</div>
                </div>`;
                
                html += `<div class="result-item">
                    <div class="result-label">–ù–∞ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –≤ –¥–µ–Ω—å</div>
                    <div class="result-value positive">${formatNumber(dailyFun)} ‚ÇΩ</div>
                </div>`;
                
                if (dailyFun < 200) {
                    html += `<div class="warning-box">
                        üí° <strong>–†–µ–∂–∏–º –∂–µ—Å—Ç–∫–æ–π —ç–∫–æ–Ω–æ–º–∏–∏</strong><br>
                        –ë—é–¥–∂–µ—Ç –Ω–∞ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –º–µ–Ω–µ–µ 200 ‚ÇΩ –≤ –¥–µ–Ω—å. –ö–æ—Ñ–µ –≤–Ω–µ –¥–æ–º–∞ –ª—É—á—à–µ –∏—Å–∫–ª—é—á–∏—Ç—å.
                    </div>`;
                } else if (dailyFun > 1000) {
                    html += `<div class="success-box">
                        üéâ <strong>–û—Ç–ª–∏—á–Ω—ã–π –±—é–¥–∂–µ—Ç!</strong><br>
                        –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–µ–±–µ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –Ω–µ–±–æ–ª—å—à–∏–µ –ø–æ–∫—É–ø–∫–∏.
                    </div>`;
                } else {
                    html += `<div class="success-box">
                        ‚úÖ <strong>–°—Ç–∞–±–∏–ª—å–Ω—ã–π –±—é–¥–∂–µ—Ç</strong><br>
                        –£ –≤–∞—Å —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å—ã. –ü—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ—Å—å –ø–ª–∞–Ω–∞.
                    </div>`;
                }
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = html;
            resultDiv.style.display = 'block';
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
            resultDiv.scrollIntoView({ behavior: 'smooth' });
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
            tg.MainButton.onClick(function() {
                // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
                let dataToSend = {
                    days: days,
                    income: income,
                    fixed: fixed,
                    debts: debts,
                    savings: savings,
                    groceries: groceries,
                    daily_total: Math.round(dailyTotal),
                    daily_fun: Math.round(dailyFun),
                    has_deficit: freeMoney < 0
                };
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
                tg.sendData(JSON.stringify(dataToSend));
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏
            tg.MainButton.show();
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ –ø–æ–ª—è
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', function() {
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–∫–∞ –Ω–µ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–ª–∏
                tg.MainButton.hide();
            });
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–º—É Telegram
        document.documentElement.style.setProperty('--tg-theme-bg-color', tg.themeParams.bg_color || '#ffffff');
        document.documentElement.style.setProperty('--tg-theme-text-color', tg.themeParams.text_color || '#000000');
        document.documentElement.style.setProperty('--tg-theme-hint-color', tg.themeParams.hint_color || '#707579');
        document.documentElement.style.setProperty('--tg-theme-button-color', tg.themeParams.button_color || '#2481cc');
        document.documentElement.style.setProperty('--tg-theme-button-text-color', tg.themeParams.button_text_color || '#ffffff');
        document.documentElement.style.setProperty('--tg-theme-secondary-bg-color', tg.themeParams.secondary_bg_color || '#f5f5f5');
    </script>
</body>
</html>